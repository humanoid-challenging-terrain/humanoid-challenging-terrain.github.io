<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.png">
    <title>Learning Humanoid Locomotion over Challenging Terrain</title>
</head>
<body>
<div id="title_slide">
    <div class="title_left">
        <h1>Learning Humanoid Locomotion <br> over Challenging Terrain</h1>
        <div class="author-container-1">
            <div class="grid-item"><a href="https://people.eecs.berkeley.edu/~ilija/">Ilija Radosavovic</a></div>
            <div class="grid-item"><a href="https://www.sartk.com/">Sarthak Kamat</a></div>
            <div class="grid-item"><a href="https://people.eecs.berkeley.edu/~trevor/">Trevor Darrell</a></div>
            <div class="grid-item"><a href="http://people.eecs.berkeley.edu/~malik/">Jitendra Malik</a></div>
        </div>
        <div class="mobile-author-container-1">
            <div class="grid-item"><a href="https://people.eecs.berkeley.edu/~ilija/">Ilija Radosavovic</a></div>
            <div class="grid-item"><a href="https://www.sartk.com/">Sarthak Kamat</a></div>
            <div class="grid-item"><a href="https://people.eecs.berkeley.edu/~trevor/">Trevor Darrell</a></div>
            <div class="grid-item"><a href="http://people.eecs.berkeley.edu/~malik/">Jitendra Malik</a></div>
        </div>
        <div class="berkeley">
            <p>University of California, Berkeley</p>
        </div>
        <div class="button-container">
            <a href="https://arxiv.org/abs/2410.03654" class="button">Paper</a>
            <!-- <a href="" class="button">Video</a> -->
        </div>

        <br>

        <div id="abstract" class="grid-container">
            <p>
            Humanoid robots can, in principle, use their legs to go almost anywhere. Developing humanoid controllers, however, remains a considerable challenge. Here, we present a learning-based approach for blind humanoid capable of locomotion over challenging natural and man-made terrain. Our method uses a transformer model to predict the next action based on the history of proprioceptive observations and actions. The model is first pre-trained on a dataset of flat-ground trajectories with sequence modeling, and then fine-tuned on uneven terrain using reinforcement learning. We evaluate our model on a real humanoid robot across a variety of terrains, including rough, deformable, and sloped surfaces. The model demonstrates robust performance, in-context adaptation, and emergent terrain representations. In real-world case studies, our humanoid traversed over 4 miles of hiking trails in Berkeley and climbed some of the steepest streets in San Francisco.
            </p>
        </div>
    </div>
</div>
<hr class="rounded">
<div id="overview">

    <p>
    We propose a method for learning humanoid locomotion over challenging terrain. Our model is a transformer that predicts the next action from the history of proprioceptive observations and actions. Our method involves a two-step training procedure. First, we pre-train the model with sequence modeling on a dataset of flat-ground trajectories. We construct a dataset using a prior neural network policy, a model-based controller, and human motion sequences. Second, we fine-tune the model with reinforcement learning on uneven terrains in simulation. Pre-training enables the model to vicariously absorb the skills from prior data and provides a good starting point for learning new skills efficiently. We call our model Humanoid Transformer 2, or HT-2 for short.
    </p>

    <h1>Pre-training with Sequence Modeling</h1>

    <p>
    Our core observation is that even though the capabilities that we want to learn, in this case humanoid locomotion over challenging terrain, are not readily available in the form of data, we can still leverage the sources of available data to learn relevant skills. Intuitively, a robot that already knows how to walk on flat ground should be better at learning how to walk up a slope, than a robot that cannot walk at all. Pre-training a humanoid model on existing trajectories is similar in spirit to pre-training a language model on the text from the Internet.
    </p>

    <div class="barplot">
        <div class="image_container">
            <img src="assets/methoda.png">
            <div class="caption" style="margin-top: 0.0vw">
                <p>Pre-training with sequence modeling.</p>
            </div>
        </div>
    </div>

    <h1>Fine-tuning with Reinforcement Learning</h1>

    <p>
    After pre-training on a dataset of trajectories, we obtain a model that is able to walk. However, since the model was trained on flat-walking trajectories its capabilities are limited mostly to gentle terrains. For example, the model cannot walk on steep slopes or terrains that are far from the pre-training dataset. Nevertheless, as our experiments show, the pre-trained model can serve as an effective starting point for acquiring new capabilities through interaction.
    </p>

    <div class="barplot">
        <div class="image_container">
            <img src="assets/methodb.png">
            <div class="caption" style="margin-top: 0.0vw">
                <p>Fine-tuning with reinforcement learning.</p>
            </div>
        </div>
    </div>

    <h1>Berkeley Hikes</h1>

    <p>
    To evaluate our approach in real-world scenarios, we perform two case studies. In the first study we take our robot to five different hikes in the Berkeley area. These are normal human hikes that are collectively about 4.3 miles long. Our policy was able to successfully complete all of the hikes.
    </p>
    <br>

    <div class="allegroupper">
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/belgum-7867-1.mov" type="video/mp4">
        </video>
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/panoramic-7795-1.mov" type="video/mp4">
        </video>
    </div>
    <div class="allegrolower">
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/scott-7878-1.mov" type="video/mp4">
            </video>
            <div class="caption">
                <p>Hiking in Berkeley.</p>
            </div>
        </div>
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/inspiration-7824-1.mov" type="video/mp4">
            </video>
        </div>
    </div>

    <h1>San Francisco Streets</h1>

    <p>
     In our second real-world study, we evaluate our controller on steep streets in San Francisco. Note that these streets are very steep and hard even for healthy human adults. Moreover, some of these streets are considerably steeper than seen during training (up to 20% grade). For example, the street shown in the top-right corner below has a slope grade of 31% which makes it among some of the steepest streets in San Francisco.
    </p>
    <br>

    <div class="allegroupper">
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/sf-7932-1.mov" type="video/mp4">
        </video>
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/sf-7917-2.mov" type="video/mp4">
        </video>
    </div>
    <div class="allegrolower">
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/sf-7919-2.mov" type="video/mp4">
            </video>
            <div class="caption">
                <p>Walking on steep streets in San Francisco.</p>
            </div>
        </div>
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/sf-7928-1.mov" type="video/mp4">
            </video>
        </div>
    </div>

    <h1>Albany Beach</h1>

    <p>
    Recall that we fine-tune the model in simulation only on rigid terrains, without soft or deformable terrains. Nevertheless, as demonstrated in our results, models fine-tuned in this way can generalize to unseen real-world terrains during deployment. We show example videos of our robot walking on a sand beach below.
    </p>
    <br>

    <div class="allegroupper">
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/beach-7908-1.mov" type="video/mp4">
        </video>
        <video autoplay muted playsinline loop preload="metadata">
            <source src="assets/page/beach-7908-2.mov" type="video/mp4">
        </video>
    </div>
    <div class="allegrolower">
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/beach-7905-3.mov" type="video/mp4">
            </video>
            <div class="caption">
                <p>Walking on sand.</p>
            </div>
        </div>
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/beach-7907-2.mov" type="video/mp4">
            </video>
        </div>
    </div>

    <h1>Push on Uneven Terrain</h1>

    <p>
    In addition to adapting to terrain changes, a strong controller should also be able to handle external disturbances. We show an example where we apply strong push while the robot is on uneven grass terrain. We see that the model quickly adapts its gait to prevent a fall and maintain balance.
    </p>
    <br>

    <div class="allegrolower">
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/push-1.mov" type="video/mp4">
            </video>
            <div class="caption">
                <p>External disturbances.</p>
            </div>
        </div>
        <div class="video_container">
            <video autoplay muted playsinline loop preload="metadata">
                <source src="assets/page/push-2.mov" type="video/mp4">
            </video>
        </div>
    </div>




    <h1>BibTeX</h1>
    <p class="bibtex">
        @article{HumanoidTerrain2024,<br>
        &nbsp;&nbsp;title={Learning Humanoid Locomotion over Challenging Terrain},<br>
        &nbsp;&nbsp;author={Ilija Radosavovic and Sarthak Kamat and Trevor Darrell and Jitendra Malik},<br>
        &nbsp;&nbsp;year={2024},<br>
        &nbsp;&nbsp;journal={arXiv:2410.03654}<br>
        }
    </p>
</div>
<script type="text/javascript">
    /* https://stackoverflow.com/questions/3027707/how-to-change-the-playing-speed-of-videos-in-html5 */
    document.querySelector('video').defaultPlaybackRate = 1.0;
    document.querySelector('video').play();

    var videos =document.querySelectorAll('video');
    for (var i=0;i<1;i++)
    {
        videos[i].playbackRate = 1.0;
    }
</script>
<script>
    /* https://stackoverflow.com/questions/21163756/html5-and-javascript-to-play-videos-only-when-visible */
    var videos = document.getElementsByTagName("video");

    function checkScroll() {
        var fraction = 0.5; // Play when 70% of the player is visible.

        for(var i = 0; i < 1; i++) {  // only apply to the first video

            var video = videos[i];

            var x = video.offsetLeft, y = video.offsetTop, w = video.offsetWidth, h = video.offsetHeight, r = x + w, //right
                b = y + h, //bottom
                visibleX, visibleY, visible;

            visibleX = Math.max(0, Math.min(w, window.pageXOffset + window.innerWidth - x, r - window.pageXOffset));
            visibleY = Math.max(0, Math.min(h, window.pageYOffset + window.innerHeight - y, b - window.pageYOffset));

            visible = visibleX * visibleY / (w * h);

            if (visible > fraction) {
                video.play();
            } else {
                video.pause();
            }

        }

    }
    window.addEventListener('scroll', checkScroll, false);
    window.addEventListener('resize', checkScroll, false);
</script>
<script>
    // Function to check if the user is on a mobile device
    function isMobileDevice() {
        return /Mobi|Android/i.test(navigator.userAgent);
    }
   
    // If the user is on a mobile device, disable autoplay
    if (isMobileDevice()) {
        const videos = document.querySelectorAll('video');
        videos.forEach(video => {
            video.autoplay = false;
            video.controls = true;
        });
    }
</script>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=51e0d73d83d06baa7a00000f"
        type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
<script src="https://uploads-ssl.webflow.com/51e0d73d83d06baa7a00000f/js/webflow.fd002feec.js"
        type="text/javascript"></script>
</body>
</html>
